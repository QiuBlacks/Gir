[TOC]

# HTTP与HTTPS

## 一、HTTP

### 1、定义

超文本传输协议，是一个基于请求与响应，**无状态**的，**应用层**的协议，常基于**TCP/IP协议**传输数据，互联网上应用最为广泛的一种网络协议,所有的WWW文件都必须遵守这个标准。设计HTTP的初衷是为了提供一种发布和接收HTML页面的方法。

### 2、版本

| 版本     | 内容                                                         |
| -------- | ------------------------------------------------------------ |
| HTTP/0.9 | 不涉及数据包传输，规定客户端和服务器之间通信格式，只能GET请求 |
| HTTP/1.0 | 传输内容格式不限制，增加PUT、PATCH、HEAD、 OPTIONS、DELETE命令 |
| HTTP/1.1 | 持久连接(长连接)、节约带宽、HOST域、管道机制、分块传输编码   |
| HTTP/2   | 多路复用、服务器推送、头信息压缩、二进制协议等               |

### 3、HTTP1.0 和 HTTP 1.1主要区别

#### 3.1 缓存处理

在HTTP1.0中主要使用header里的If-Modified-Since,Expires来做为缓存判断的标准，HTTP1.1则引入了更多的缓存控制策略例如Entity tag，If-Unmodified-Since, If-Match, If-None-Match等更多可供选择的缓存头来控制缓存策略。

#### 3.2 带宽优化及网络连接的使用

HTTP1.0中，存在一些浪费带宽的现象，例如客户端只是需要某个对象的一部分，而服务器却将整个对象送过来了，并且不支持断点续传功能

HTTP1.1则在请求头引入了range头域，它允许只请求资源的某个部分，即返回码是206（Partial Content），这样就方便了开发者自由的选择以便于充分利用带宽和连接。

#### 3.3 错误通知的管理

在HTTP1.1中新增了24个错误状态响应码，如409（Conflict）表示请求的资源与资源的当前状态发生冲突；410（Gone）表示服务器上的某个资源被永久性的删除。

#### 3.4 Host头处理

在HTTP1.0中认为每台服务器都绑定一个唯一的IP地址，因此，请求消息中的URL并没有传递主机名（hostname）。但随着虚拟主机技术的发展，在一台物理服务器上可以存在多个虚拟主机（Multi-homed Web Servers），并且它们共享一个IP地址。	

HTTP1.1的请求消息和响应消息都应支持Host头域，且请求消息中如果没有Host头域会报告一个错误（400 Bad Request）

#### 3.5 长连接

HTTP 1.0需要使用keep-alive参数来告知服务器端要建立一个长连接，而HTTP1.1默认支持长连接。



### 4、 HTTP 2.0和HTTP 1.1主要区别

#### 4.1 多路复用

HTTP2.0使用了多路复用的技术，做到同一个连接并发处理多个请求，而且并发请求的数量比HTTP1.1大了好几个数量级。

当然HTTP1.1也可以多建立几个TCP连接，来支持处理更多并发的请求，但是创建TCP连接本身也是有开销的。

#### 4.2 数据压缩

HTTP1.1不支持header数据的压缩，HTTP2.0使用HPACK算法对header的数据进行压缩，这样数据体积小了，在网络上传输就会更快。

#### 4.3 服务器推送

当我们对支持HTTP2.0的web server请求数据的时候，服务器会**主动把一些客户端需要的资源一起推送到客户端**，免得客户端再次创建连接发送请求到服务器端获取。这种方式非常合适加载静态资源。

服务器端推送的这些资源其实存在客户端的某处地方，客户端直接从本地加载这些资源就可以了，不用走网络，速度自然是快很多的。

#### 4.4  二进制分帧

HTTP2.0采用二进制帧格式而非文本格式

帧：HTTP2.0通信的最小单位，每个帧包含帧头部，至少也会标识出当前帧所属的流

帧对数据进行顺序标识，如下图所示，这样浏览器收到数据之后，就可以按照序列对数据进行合并，而不会出现合并后数据错乱的情况。同样是因为有了序列，服务器就可以并行的传输数据，这就是流所做的事情。



## 二、HTTPS

### 1、产生背景

HTTP（超文本传输协议）被用于在Web浏览器和网站服务器之间，以**明文**方式传递信息，**不提供任何方式的数据加密**，因此使用HTTP协议传输隐私信息（如：银行卡号、密码等支付信息）非常不安全。

为了解决这一安全缺陷，网景公司设计了SSL（Secure Sockets Layer）协议，在HTTP的基础上加入了SSL（Secure Sockets Layer）协议，SSL依靠SSL证书来验证服务器的身份，并为浏览器和服务器之间的通信加密。从而诞生了HTTPS（安全套接字层超文本传输协议）

### 2、定义

HTTP+SSL（TLS）

HTTPS是一种通过计算机网络进行安全通信的传输协议，经由HTTP进行通信，利用SSL/TLS建立全信道，加密数据包。

HTTPS使用的主要目的是提供对网站服务器的身份认证，同时保护交换数据的隐私与完整性。



### 3、安全措施

 采用 对称加密 和 非对称加密 结合的方式来保护浏览器和服务端之间的通信安全。

对称加密算法加密数据+非对称加密算法交换密钥+数字证书验证身份=安全



### 4、HTTPS的优点

尽管HTTPS并非绝对安全，掌握根证书的机构、掌握加密算法的组织同样可以进行中间人形式的攻击，但HTTPS仍是现行架构下最安全的解决方案，主要有以下几个有点：

- 使用HTTPS协议可认证用户和服务器，确保数据发送到正确的客户机和服务器；
- HTTPS是现行架构下最安全的解决方案，虽然不是绝对安全，但它大幅增加了中间人攻击的成本。
- 谷歌曾在2014年8月份调整搜索引擎算法，并称“比起同等HTTP网站，采用HTTPS加密的网站在搜索结果中的排名将会更高”。

### 5、什么时候该使用HTTPS

当你访问银行网站、支付网关、购物网站、登录页、电子邮件之类需要敏感信息的网站时，应该使用 HTTPS。

> Tip：如果某个网站要求你填写银行卡之类的敏感信息，首先你要检查该网页是否使用HTTPS加密连接。如果没有，那么请不要输入任何敏感信息，如：信用卡号、密码。



### 6、HTTP切换到HTTPS

实现将网站从HTTP切换到HTTPS，你可以：

- 手动更改：需要将页面中所有的链接，例如js，css，图片等等URL都由HTTP改为HTTPS。
- 联系亚洲诚信400-880-8600，我们配有专业的技术人员全面负责SSL证书售后服务，帮助你轻松实现[HTTPS全站加密](https://www.trustasia.com/https)。



### 7、HTTP和HTTPS的区别

<img src="https://gitee.com/BlacksJack/picture-bed/raw/master/img/20200910183102.png" alt="image-20200728100904569" style="zoom:67%;" />



- **工作层**：在OSI网络模型中，HTTP工作于**应用层**，而HTTPS工作在传输层。

- **连接端口**：HTTP标准端口是80，而HTTPS的标准端口是443。

- **传输方式**：HTTP是超文本传输协议，信息是明文传输，而HTTPS是SSL加密传输协议。

- **工作耗时**：HTTP耗时=TCP握手，而HTTPS耗时=TCP握手+SSL握手。

- **显示形式**：HTTP的URL以http://开头，而HTTPS的URL以https://开头。

- **费用**：HTTP无需费用，而HTTPS需要到CA申请证书，一般免费证书较少，需要一定费用。

- **安全性**：HTTP的连接很简单，是无状态的；HTTPS协议是由SSL+HTTP协议构建的可进行加密传输、身份认证的网络协议，比HTTP协议安全。

  



## 三、HTTPS加密过程



![image-20200728102024923](https://gitee.com/BlacksJack/picture-bed/raw/master/img/20200910183103.png)

1、客户端请求服务器获取证书公钥

2、客户端（SSL/TLS）解析证书（无效则弹出警告）

3、生成随机密码

4、用公钥加密随机值生成密钥

5、客户端发送密钥给服务端

6、服务端用私钥解密密钥得到随机值（前面的是非对称加密）

7、使用随机值进行信息加密，双方进行传输数据（对称加密）







## 参考文章

[HTTP与HTTPS的区别](https://help.trustasia.com/http-vs-https/)

[HTTPS加密过程详解](https://segmentfault.com/a/1190000019976390)

[http和https区别，三分钟了解这两者的区别](https://www.changchenghao.cn/n/268257.html)