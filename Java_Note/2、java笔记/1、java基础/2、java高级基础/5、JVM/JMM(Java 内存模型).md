# JMM(Java 内存模型)

---
# 一、基本介绍
## 1、基本概念
&emsp;&emsp;Java ==线程之间的通信由 Java 内存模型（本文简称为 JMM）控制==，JMM 决定一个线程对共享变量的写入何时对另一个线程可见。<br>
&emsp;&emsp;从抽象的角度来看，JMM 定义了线程和主内存之间的抽象关系：线程之间的共享变量存储在主内存（main memory）中，每个线程都有一个私有的本地内存（local memory），本地内存中存储了该线程以读 / 写共享变量的副本。<br>
&emsp;&emsp;本地内存是 JMM 的一==个抽象概念==，并不真实存在。它涵盖了缓存，写缓冲区，寄存器以及其他的硬件和编译器优化。
## 2、Java 内存模型的抽象示意图
![image](https://www.pdai.tech/_images/jvm/java-jmm-1.png)

&emsp;&emsp;从上图来看，线程 A 与线程 B 之间如要通信的话，必须要经历下面 2 个步骤： 
- 首先，线程 A 把本地内存 A 中更新过的共享变量刷新到主内存中去。
- 然后，线程 B 到主内存中去读取线程 A 之前已更新过的共享变量。
 
&emsp;&emsp;JMM 通过控制主内存与每个线程的本地内存之间的交互，来为 java 程序员提供内存可见性保证


# 三、JDK7和JDK8的JVM内存模型比较

## 1、区别
- 元数据区取代了永久代，就是JDK8没有了PermSize相关的参数配置了。

- 元空间的本质和永久代类似，都是对JVM规范中方法区的实现。不过元空间与永久代之间最大的区别在于：元数据空间并不在虚拟机中，而是使用本地内存。