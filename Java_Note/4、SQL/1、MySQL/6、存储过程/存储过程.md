# **存储过程**

# **一、基本介绍**

## **1、定义**

存储过程是SQL语句和控制语句的预编译集合，以一个名称存储并座位一个单元处理。

## **2、作用**

说到存储过程的作用，咱们先来说一下写了sql命令之后到拿到返回结果，mysql都经历了哪些。

1、首先输入sql命令之后，mysql引擎会首先对sql命令进行语法分析，来检查sql命令是不是正确

2、如果sql命令是正确的，那么sql命令会通过编译转化成msyql可以识别的命令

3、然后开始执行命令

4、最后将结果返回给客户端

有了上述的这个过程，那咱们如果把检查命令和编译省略掉，就能提升sql命令的效率。那么问题来了，

怎么能省略掉前边的步骤呢？就是是用存储过程！

在一条sql命令第一次被执行的时候，同样会经历上述四个步骤。但是从第二次起，就不用再重新检查和编译了。

## **3、优点**

- - 增强了SQL语句的功能和灵活性。在存储过程中可以用变量以及判断等，就可以使用存储过程完成比较复杂的功能。
  - 实现了比较快的执行速度。如果在一个操作包含大量的sql命令，效率较低。频繁调用时在使用存储过程效率较高。
  - 减少网络流量。如果要执行一个操作，要写一个完成的sql命令进去。但是如果使用存储过程，那就传递参数就好了，这样提交给服务器的内容就少了很多。

# **二、基本语法**

## **1、创建**

### **1）语法**

CREATE [DEFINER = {user|CURRENT_USER}] PROCEDURE sp_name ([proc_parameter[,...]]) [characteristic ...] routine_body proc_parameter:[IN|OUT|INOUT] param_name type

### **2）参数**

IN: 表示该参数的值必须在调用存储过程时指定；

OUT: 表示该参数的值可以被存储过程改变，并且可以返回；

INOUT: 表示该参数的值调用时指定，并且可以被改变和返回。

### **3）过程体特点：**

- 过程体由合法的 SQL 语句组成；
- 过程体可以是任意 SQL 语句；
- 过程体如果为复合结构则使用 BEGIN…END 语句；
- 复合结构可以包含声明，循环，控制结构。

### **4）无参创建**

 CREATE PROCEDURE sp1() SELECT VERSION;



## 2、调用

**1）语法**	

含参：CALL sp_name([parameter[,...]]) 无参：CALL sp_name[()]



## 3、删除

DROP PROCEDURE sp1;



# **三、存储过程与自定义函数的区别：**

\1. 存储过程实现的功能复杂些；函数的针对性更强。

\2. 存储过程可以返回多个值；函数只有一个返回值。

\3. 存储过程一般独立的来执行；而函数可以作为其他 SQL 语句的组成部分来实现。