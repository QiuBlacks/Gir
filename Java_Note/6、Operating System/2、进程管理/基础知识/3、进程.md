# 进程



​	是程序的一次执行过程，或是正在运行的一个程序，是一个动态的过程，是**资源分配的最小单位**

## 特点：

1）结构性 每个进程有一个控制块 PCB。

2）动态性 进程的实质是进程实体的一次执行过程。动态性是进程的最基本的特征。

3）并发性 可以与其它进程一道在宏观上同时向前推进。动态性是进程的重要特征。

4）独立性 进程是一个能独立运行 独立分配资源和独立调度的基本单位。

5）异步性（不确定性） 每个进程都以其相对独立、不可预知的速度向前推进。

## 一、进程调度算法:CPU 调度算法

- **先到先服务(FCFS)调度算法** : 从就绪队列中选择一个最先进入该队列的进程为之分配资源，使它立即执行并一直执行到完成或发生某事件而被阻塞放弃占用 CPU 时再重新调度。
- **短作业优先(SJF)的调度算法** : 从就绪队列中选出一个估计运行时间最短的进程为之分配资源，使它立即执行并一直执行到完成或发生某事件而被阻塞放弃占用 CPU 时再重新调度。
- **时间片轮转调度算法** : 时间片轮转调度是一种最古老，最简单，最公平且使用最广的算法，又称 RR(Round robin)调度。每个进程被分配一个时间段，称作它的时间片，即该进程允许运行的时间。
- **多级反馈队列调度算法** ：前面介绍的几种进程调度的算法都有一定的局限性。如**短进程优先的调度算法，仅照顾了短进程而忽略了长进程** 。多级反馈队列调度算法既能使高优先级的作业得到响应又能使短作业（进程）迅速完成。，因而它是目前**被公认的一种较好的进程调度算法**，UNIX 操作系统采取的便是这种调度算法。
- **优先级调度** ： 为每个流程分配优先级，首先执行具有最高优先级的进程，依此类推。具有相同优先级的进程以 FCFS 方式执行。可以根据内存要求，时间要求或任何其他资源要求来确定优先级。





## 二、为什么进程切换的开销比线程切换大呢？

进程切换的代价：切换虚拟地址空间，切换内核栈和硬件上下文

线程切换的代价：切换内核栈和硬件上下文	

### 主要性能消耗：

1、这两种上下文切换的处理都是通过操作系统内核来完成的。内核的这种切换过程伴随的**最显著的性能损耗是将寄存器中的内容切换出**。

2、上下文的切换会扰乱处理器的缓存机制。CPU高速缓存失效。页表查找是一个很慢的过程，因此通常使用Cache来缓存常用的地址映射，这样可以加速页表查找，这个cache就是TLB（页表缓冲）。

当进程切换后页表也要进行切换，页表切换后TLB就失效了，cache失效导致命中率降低，那么虚拟地址转换为物理地址就会变慢，表现出来的就是程序运行会变慢

而且线程只需要保存线程的上下文（相关寄存器状态和栈的信息）就好了，动作很小



## 进程调度时机

进程调度时机：当前运行进程主动放弃处理机和当前运行进程被动放弃处理机。

主动放弃处理机：（1）进程正常终止 运行态->终止态 (2)运行过程中发生异常而终止 运行态->终止态（3）进程主动请求阻塞 如等待I/O 运行态->阻塞态

被动放弃处理机：（1）分给进程的时间片用完 运行态->就绪态 (2)有更紧急的事需要处理 如I/O中断 运行态->就绪态 (3)有更高优先级的进程进入就绪队列 运行态->就绪态 





挂起就绪态

![img](https://gitee.com/BlacksJack/picture-bed/raw/master/img/20200915110343.png)



