# Linux磁盘分区、挂载

## 一、 Linux分区

### 1、 原理介绍

1)Linux来说无论有几个分区，分给哪一目录使用，它归根结底就只有一个根目录，一个独立且唯一的文件结构 , Linux中每个分区都是用来组成整个文件系统的一部分。

2)Linux采用了一种叫“载入”的处理方法，它的整个文件系统中包含了一整套的文件和目录，且将一个分区和一个目录联系起来。这时要载入的一个分区将使它的存储空间在一个目录下获得。

3)示意图

![image-20200513232230294](E:\black user\Java\有道云截图\image-20200513232230294.png)

# 二、 硬盘说明

1、Linux硬盘分 IDE硬盘和 SCSI硬盘，目前基本上是 SCSI硬盘

2、对于 IDE硬盘，驱动器标识符为“hdx~”,其中“hd”表明分区所在设备的类型，这里是指 IDE硬盘了。“x”为盘号（a为基本盘，b为基本从属盘，c为辅助主盘，d为辅助从属盘）,“~”代表分区，前四个分区用数字 1到 4表示，它们是主分区或扩展分区，从 5开始就是逻辑分区。例，hda3表示为第一个 IDE硬盘上的第三个主分区或扩展分区,hdb2表示为第二个 IDE硬盘上的第二个主分区或扩展分区。

3、对于 SCSI硬盘则标识为“sdx~”，SCSI 硬盘是用“sd”来表示分区所在设备的类型的，其余则和IDE硬盘的表示方法一样



# 三、 使用 lsblk指令查看当前系统的分区情况

<img src="E:\black user\Java\有道云截图\image-20200513232314366.png" alt="image-20200513232314366" style="zoom:150%;" />



# 四、 挂载的经典案例

![image-20200513232333803](E:\black user\Java\有道云截图\image-20200513232333803.png)



## 1、 如何增加一块硬盘

1)虚拟机添加硬盘

2)分区        fdisk /dev/sdb

3)格式化   mkfs -t ext4 /dev/sdb1

4)挂载 先创建一个 /home/newdisk , 挂载 mount /dev/sdb1 /home/newdisk

5)设置可以自动挂载(永久挂载，当你重启系统，仍然可以挂载到 /home/newdisk) 。

vim /etc/fstab

/dev/sdb1                    /home/newdisk                      ext4        defaults                                    0 0

## 2、具体的操作步骤整理

#### 1） 虚拟机增加硬盘步骤 1

在【虚拟机】菜单中，选择【设置】，然后设备列表里添加硬盘，然后一路【下一步】，中间只有选择磁盘大小的地方需要修改，至到完成。然后重启系统（才能识别）！

![image-20200513232403170](E:\black user\Java\有道云截图\image-20200513232403170.png)



#### 2） 虚拟机增加硬盘步骤 2

分区命令 fdisk /dev/sdb

开始对/sdb分区

•m 显示命令列表

•p        显示磁盘分区 同 fdisk –l

•n        新增分区

•d          删除分区

•w 写入并退出

说明： 开始分区后输入 n，新增分区，然后选择 p ，分区类型为主分区。两次回车默认剩余全
 部空间。最后输入 w写入分区并退出，若不保存退出输入 q。

 

#### 3） 虚拟机增加硬盘步骤 3

格式化磁盘

分区命令:mkfs -t ext4 /dev/sdb1

其中 ext4是分区类型

#### 4） 虚拟机增加硬盘步骤 4

挂载: 将一个分区与一个目录联系起来，

•mount        设备名称 挂载目录

•例如： mount        /dev/sdb1        /newdisk

•umount 设备名称 或者 挂载目录

•例如： umount /dev/sdb1 或者 umount /newdisk

#### 5） 虚拟机增加硬盘步骤 5

永久挂载: 通过修改/etc/fstab实现挂载

添加完成后 执行 mount –a 即刻生效

# 五、 磁盘情况查询

## 1、 查询系统整体磁盘使用情况

基本语法

df -h

应用实例

查询系统整体磁盘使用情况

 

## 2、 查询指定目录的磁盘占用情况

•基本语法

du -h /目录

查询指定目录的磁盘占用情况，默认为当前目录

-s 指定目录占用大小汇总

-h 带计量单位

-a 含文件

--max-depth=1 子目录深度
-c 列出明细的同时，增加汇总值



## •应用实例

查询 /opt 目录的磁盘占用情况，深度为 1



 

# 12.6 磁盘情况-工作实用指令

1) 统计/home文件夹下文件的个数

 ![image-20200513232458046](E:\black user\Java\有道云截图\image-20200513232458046.png)

 


2) 统计/home文件夹下目录的个数

![image-20200513232506599](E:\black user\Java\有道云截图\image-20200513232506599.png)



3) 统计/home文件夹下文件的个数，包括子文件夹里的

 ![image-20200513232514822](E:\black user\Java\有道云截图\image-20200513232514822.png)



4) 统计文件夹下目录的个数，包括子文件夹里的

![image-20200513232522898](E:\black user\Java\有道云截图\image-20200513232522898.png)



5) 以树状显示目录结构

![image-20200513232537093](E:\black user\Java\有道云截图\image-20200513232537093.png)